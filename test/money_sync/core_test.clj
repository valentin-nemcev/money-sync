(ns money-sync.core-test
  (:require [clojure.test :refer :all]
            [money-sync.core :refer :all]))

(deftest parse-transactions
  (is (= (parse-csv-file "./resources/transactions.csv")
         `(["Тип счёта" "Номер счета" "Валюта" "Дата операции" "Референс проводки" "Описание операции" "Приход" "Расход" ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "22.05.17"
             "HOLD"
             "10357009 RU PEREKRESTOK SVERDLOVSK> 17.05.22 17.05.22 952.00 RUR 548673++++++3137"
             "0"
             "952"
             ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "21.05.17"
             "MOWV 21705000584"
             "Ком.за пер.с исп.рас.карты ОАО\"АЛЬФА-БАНК \",вып.к Тек.сч.Кл.,на сч.карты стор.банк.Согл.тар.Банка Немцева Юлия Сергеевна"
             "0"
             "185,25"
             ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "21.05.17"
             "CRD_4XR24Z"
             "548673++++++3137    10357010\\RUS\\SANKT PETERBU\\PEREKRESTOK S          21.05.17 18.05.17      1334.00  RUR MCC5411"
             "0"
             "1334"
             ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "21.05.17"
             "CRD_7U9213"
             "510126++++++6530      809131\\643\\MOSKVA\\CARD2CARD CLK                 21.05.17 20.05.17      9500.00  RUR MCC6012"
             "0"
             "9500"
             ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "20.05.17"
             "C012005170005237"
             "Перевод                                                               01N 45415 2005 40817810108900008075044525593 30101810200000000593"
             "0"
             "7000"
             ""]
            ["Текущий счёт"
             "40817810807150018598"
             "RUR"
             "19.05.17"
             "OP1ED02112339436"
             "Зарплата                                                              01N     1 1905 40817810903001601210044030723 30101810100000000723"
             "15686,2"
             "0"
             ""]))))

